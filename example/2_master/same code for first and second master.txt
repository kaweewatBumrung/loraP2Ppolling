same code for first and second master